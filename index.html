

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Water &mdash; Water 0.1.0-dev documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Water" href="readme.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> Water
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html">Water</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#overview">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#concepts">Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="readme.html#primitive">Primitive</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#template">Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#pipeline">Pipeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#current-tasks-and-pipelines">Current tasks and pipelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="readme.html#timeseriesestimator">TimeSeriesEstimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#timeseriesloader">TimeSeriesLoader</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#time-series-dataset">Time series dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#tuning">Tuning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#getting-started">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="readme.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#usage-example">Usage Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="readme.html#load-and-explore-the-data">Load and explore the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#split-the-data">Split the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#finding-the-best-pipeline">Finding the best Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html#trying-new-templates">Trying new templates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="readme.html#what-s-next">What’s next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#stable-release">Stable release</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#from-source">From source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/water.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/water.html#submodules">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/water.db.html">water.db module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/water.estimators.html">water.estimators module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/water.loader.html">water.loader module</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/water.utils.html">water.utils module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Development Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#types-of-contributions">Types of Contributions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#report-bugs">Report Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#fix-bugs">Fix Bugs</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#implement-features">Implement Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#write-documentation">Write Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="contributing.html#submit-feedback">Submit Feedback</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#unit-testing-guidelines">Unit Testing Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#tips">Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html#release-workflow">Release Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a><ul>
<li class="toctree-l2"><a class="reference internal" href="authors.html#development-lead">Development Lead</a></li>
<li class="toctree-l2"><a class="reference internal" href="authors.html#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a><ul>
<li class="toctree-l2"><a class="reference internal" href="history.html#id1">0.1.0</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Water</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Water</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/D3-AI/water/blob/master/docs/index.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p align="left">
<img width=15% src="https://dai.lids.mit.edu/wp-content/uploads/2018/06/Logo_DAI_highres.png" alt=“DaiLab” /><a href="https://www.xylem.com/" target="_blank"><img width=15% src="https://upload.wikimedia.org/wikipedia/en/thumb/2/2d/Xylem_Logo.svg/1920px-Xylem_Logo.svg.png" alt="XylemLogo"/></a>
<br/>
<i>A collaborative open source project between Data to AI Lab at MIT and Xylem Inc..</i>
</p><a class="reference external image-reference" href="https://pypi.python.org/pypi/ml-water"><img alt="PyPI Shield" src="https://img.shields.io/pypi/v/water.svg" /></a>
<a class="reference external image-reference" href="https://travis-ci.org/D3-AI/water"><img alt="Travis CI Shield" src="https://travis-ci.org/D3-AI/water.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://pepy.tech/project/ml-water"><img alt="Downloads" src="https://pepy.tech/badge/ml-water" /></a>
<div class="section" id="water">
<h1>Water<a class="headerlink" href="#water" title="Permalink to this headline">¶</a></h1>
<p>Machine learning for internet of things related to water systems.</p>
<ul class="simple">
<li><p>Free software: MIT license</p></li>
<li><p>Documentation: <a class="reference external" href="https://D3-AI.github.io/water">https://D3-AI.github.io/water</a></p></li>
<li><p>Homepage: <a class="reference external" href="https://github.com/D3-AI/water">https://github.com/D3-AI/water</a></p></li>
</ul>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<p>The Water project is a collection of end-to-end solutions for machine learning tasks commonly found in monitoring water distribution and delivery networks. Most tasks utilize sensor data emanating from monitoring systems. We utilize the foundational innovations developed for automation of machine Learning at Data to AI Lab at MIT. This project is developed in close collaboration with Xylem Inc.</p>
<p>The salient aspects of this customized project are:</p>
<ul class="simple">
<li><p>A set of ready to use, well tested pipelines for different machine learning tasks. These are vetted through testing across multiple publicly available datasets for the same task.</p></li>
<li><p>An easy interface to specify the task, pipeline, and generate results and summarize them.</p></li>
<li><p>A production ready, deployable pipeline.</p></li>
<li><p>An easy interface to <code class="docutils literal notranslate"><span class="pre">tune</span></code> pipelines using Bayesian Tuning and Bandits library.</p></li>
<li><p>A community oriented infrastructure to incorporate new pipelines.</p></li>
<li><p>A robust continuous integration and testing infrastructure.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">learning</span> <span class="pre">database</span></code> recording all past outcomes –&gt; tasks, pipelines, outcomes.</p></li>
</ul>
<div class="section" id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Permalink to this headline">¶</a></h2>
<p>Before diving into the software usage, we briefly explain some concepts and terminology.</p>
<div class="section" id="primitive">
<h3>Primitive<a class="headerlink" href="#primitive" title="Permalink to this headline">¶</a></h3>
<p>We call the smallest computational blocks used in a Machine Learning process
<strong>primitives</strong>, which:</p>
<ul class="simple">
<li><p>Can be either classes or functions.</p></li>
<li><p>Have some initialization arguments, which MLBlocks calls <code class="docutils literal notranslate"><span class="pre">init_params</span></code>.</p></li>
<li><p>Have some tunable hyperparameters, which have types and a list or range of valid values.</p></li>
</ul>
</div>
<div class="section" id="template">
<h3>Template<a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h3>
<p>Primitives can be combined to form what we call <strong>Templates</strong>, which:</p>
<ul class="simple">
<li><p>Have a list of primitives.</p></li>
<li><p>Have some initialization arguments, which correspond to the initialization arguments
of their primitives.</p></li>
<li><p>Have some tunable hyperparameters, which correspond to the tunable hyperparameters
of their primitives.</p></li>
</ul>
</div>
<div class="section" id="pipeline">
<h3>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this headline">¶</a></h3>
<p>Templates can be used to build <strong>Pipelines</strong> by taking and fixing a set of valid
hyperparameters for a Template. Hence, Pipelines:</p>
<ul class="simple">
<li><p>Have a list of primitives, which corresponds to the list of primitives of their template.</p></li>
<li><p>Have some initialization arguments, which correspond to the initialization arguments
of their template.</p></li>
<li><p>Have some hyperparameter values, which fall within the ranges of valid tunable
hyperparameters of their template.</p></li>
</ul>
<p>A pipeline can be fitted and evaluated using the MLPipeline API in MLBlocks.</p>
</div>
</div>
<div class="section" id="current-tasks-and-pipelines">
<h2>Current tasks and pipelines<a class="headerlink" href="#current-tasks-and-pipelines" title="Permalink to this headline">¶</a></h2>
<p>In our current phase, we are addressing two tasks - time series classification and time series regression. To provide solutions for these two tasks we have two components.</p>
<div class="section" id="timeseriesestimator">
<h3>TimeSeriesEstimator<a class="headerlink" href="#timeseriesestimator" title="Permalink to this headline">¶</a></h3>
<p>This class is the one in charge of learning from the data and making predictions by building
<a class="reference external" href="https://hdi-project.github.io/MLBlocks">MLBlocks</a> and later on tuning them using
<a class="reference external" href="https://hdi-project.github.io/BTB/">BTB</a></p>
<p>This class comes in two flavours in the form of subclasses, the <strong>TimeSeriesClassifier</strong> and the
<strong>TimeSeriesRegressor</strong>, to be used in the corresponding problem types.</p>
</div>
<div class="section" id="timeseriesloader">
<h3>TimeSeriesLoader<a class="headerlink" href="#timeseriesloader" title="Permalink to this headline">¶</a></h3>
<p>A class responsible for loading the time series data from CSV files, and return it in the
format ready to be used by the <strong>TimeSeriesEstimator</strong>.</p>
</div>
<div class="section" id="time-series-dataset">
<h3>Time series dataset<a class="headerlink" href="#time-series-dataset" title="Permalink to this headline">¶</a></h3>
<p>A dataset is a folder that contains time series data and information about
a Machine Learning problem in the form of CSV and JSON files.</p>
<p>The expected contents of the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> folder are:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">metadata.json</span></code> with information about all the tables found in the dataset. This file follows the <a class="reference external" href="https://github.com/HDI-Project/MetaData.json">Metadata.json schema</a> with three small modifications:</p>
<ul>
<li><p>The root document has a <code class="docutils literal notranslate"><span class="pre">name</span></code> entry, with the name of the dataset.</p></li>
<li><p>The foreign key columns are be of type <code class="docutils literal notranslate"><span class="pre">id</span></code> and subtype <code class="docutils literal notranslate"><span class="pre">foreign</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">datetime</span></code> columns that are time indexes need to have the <code class="docutils literal notranslate"><span class="pre">time_index</span></code> subtype.</p></li>
</ul>
</li>
<li><p>A CSV file containing the training samples with, at least, the following columns:</p>
<ul>
<li><p>A unique index</p></li>
<li><p>A foreign key to at least one timeseries table</p></li>
<li><p>A time index that works as the cutoff time for the training example</p></li>
<li><p>If the problem is supervised, a target column.</p></li>
</ul>
</li>
</ul>
<p>Then, for each type of timeseries that exist in the dataset, there will be:</p>
<ul class="simple">
<li><p>A CSV file containing the id of each timeseries and any additional information associated with it</p></li>
<li><p>A CSV file containing the timeseries data with the following columns:</p>
<ul>
<li><p>A unique index</p></li>
<li><p>A foreign key to the timeseries table</p></li>
<li><p>A time index</p></li>
<li><p>At least a value column</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="tuning">
<h3>Tuning<a class="headerlink" href="#tuning" title="Permalink to this headline">¶</a></h3>
<p>We call tuning the process of, given a dataset and a template, find the pipeline derived from the
given template that gets the best possible score on the given dataset.</p>
<p>This process usually involves fitting and evaluating multiple pipelines with different hyperparameter
values on the same data while using optimization algorithms to deduce which hyperparameters are more
likely to get the best results in the next iterations.</p>
<p>We call each one of these tries a <strong>tuning iteration</strong>.</p>
</div>
</div>
</div>
<div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>The simplest and recommended way to install <strong>Water</strong> is using pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install ml-water
</pre></div>
</div>
<p>For development, you can also clone the repository and install it from sources</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone git@github.com:D3-AI/water.git
<span class="nb">cd</span> water
make install-develop
</pre></div>
</div>
</div>
<div class="section" id="usage-example">
<h2>Usage Example<a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<p>In this example we will load some demo data using the <strong>TimeSeriesLoader</strong> and fetch it to the
<strong>TimeSeriesClassifier</strong> for it to find the best possible pipeline, fit it using the given data
and then make predictions from it.</p>
<div class="section" id="load-and-explore-the-data">
<h3>Load and explore the data<a class="headerlink" href="#load-and-explore-the-data" title="Permalink to this headline">¶</a></h3>
<p>We first create a loader instance, passing the path to the dataset, the name of the column
that we want to predict, and the name of the table where this column can be taken from.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">water.loader</span> <span class="kn">import</span> <span class="n">TimeSeriesLoader</span>

<span class="n">loader</span> <span class="o">=</span> <span class="n">TimeSeriesLoader</span><span class="p">(</span>
    <span class="n">dataset_path</span><span class="o">=</span><span class="s1">&#39;examples/datasets/ItalyPowerDemand&#39;</span><span class="p">,</span>
    <span class="n">target_table</span><span class="o">=</span><span class="s1">&#39;demand&#39;</span><span class="p">,</span>
    <span class="n">target_column</span><span class="o">=</span><span class="s1">&#39;target&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Then we call the <code class="docutils literal notranslate"><span class="pre">loader.load</span></code> method, which will return three elements:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code>: The contents of the target table, where the training examples can be found, without the target column.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>: The target column, as extracted from the target table.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>: A dictionary containing the additional elements that the Pipeline will need to run, including the actual time series data.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div>
<table class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>demand_id</th>
      <th>timeseries_id</th>
      <th>cutoff_time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>2010-01-25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2010-01-25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>2010-01-25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>2010-01-25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>2010-01-25</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mi">1</span>
<span class="mi">1</span>    <span class="mi">1</span>
<span class="mi">2</span>    <span class="mi">2</span>
<span class="mi">3</span>    <span class="mi">2</span>
<span class="mi">4</span>    <span class="mi">1</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;entities&#39;</span><span class="p">,</span> <span class="s1">&#39;relationships&#39;</span><span class="p">,</span> <span class="s1">&#39;target_entity&#39;</span><span class="p">,</span> <span class="s1">&#39;target_column&#39;</span><span class="p">,</span> <span class="s1">&#39;dataset_name&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="split-the-data">
<h3>Split the data<a class="headerlink" href="#split-the-data" title="Permalink to this headline">¶</a></h3>
<p>If we want to split the data in train and test subsets, we can do so by splitting the <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="finding-the-best-pipeline">
<h3>Finding the best Pipeline<a class="headerlink" href="#finding-the-best-pipeline" title="Permalink to this headline">¶</a></h3>
<p>Once we have loaded the data, we create a <strong>TimeSeriesClassifier</strong> instance and call its <code class="docutils literal notranslate"><span class="pre">tune</span></code> method to
find the best possible pipeline for our data.</p>
<p>We start by importing the <code class="docutils literal notranslate"><span class="pre">TimeSeriesClassifier</span></code> and creating an instance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">water.estimators</span> <span class="kn">import</span> <span class="n">TimeSeriesClassifier</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>

<span class="n">tsc</span> <span class="o">=</span> <span class="n">TimeSeriesClassifier</span><span class="p">()</span>
</pre></div>
</div>
<p>We then pass the <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> partitions and the <code class="docutils literal notranslate"><span class="pre">data</span></code> dictionary, along with the number of tuning iterations
that we want to perform to the <code class="docutils literal notranslate"><span class="pre">tune</span></code> method, which will run the indicated number of iterations
trying to figure out the best possible hyperparameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tsc</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>After the tuning process has finished, the hyperparameters have been already set in the classifier.</p>
<p>We can see the found hyperparameters by calling the <code class="docutils literal notranslate"><span class="pre">get_hyperparameters</span></code> method</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tsc</span><span class="o">.</span><span class="n">get_hyperparameters</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span>{&#39;mlprimitives.preprocessing.ClassEncoder#1&#39;: {},
 &#39;featuretools.dfs#1&#39;: {&#39;encode&#39;: True,
  &#39;max_depth&#39;: 2,
  &#39;remove_low_information&#39;: False},
 &#39;sklearn.preprocessing.Imputer#1&#39;: {&#39;missing_values&#39;: &#39;NaN&#39;,
  &#39;axis&#39;: 0,
  &#39;copy&#39;: True,
  &#39;strategy&#39;: &#39;mean&#39;},
 &#39;xgboost.XGBClassifier#1&#39;: {&#39;n_jobs&#39;: -1,
  &#39;n_estimators&#39;: 409,
  &#39;max_depth&#39;: 8,
  &#39;learning_rate&#39;: 0.45727735286952875,
  &#39;gamma&#39;: 0.7661016859076536,
  &#39;min_child_weight&#39;: 2},
 &#39;mlprimitives.preprocessing.ClassDecoder#1&#39;: {}}
</pre></div>
</div>
<p>as well as the obtained cross validation score by looking at the <code class="docutils literal notranslate"><span class="pre">score</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">tsc</span></code> object</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tsc</span><span class="o">.</span><span class="n">score</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span><span class="p">.</span><span class="mi">6212121212121213</span>
</pre></div>
</div>
<p>Once we are satisfied with the obtained cross validation score, we can proceed to call
the <code class="docutils literal notranslate"><span class="pre">fit</span></code> method passing again the same data elements.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tsc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>After this, we are ready to make predictions on new data</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">tsc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="trying-new-templates">
<h3>Trying new templates<a class="headerlink" href="#trying-new-templates" title="Permalink to this headline">¶</a></h3>
<p>The <strong>TimeSeriesClassifier</strong> and <strong>TimeSeriesRegressor</strong> have a default template for each problem.</p>
<p>This template can be overriden by passing a new template dictionary when the instance is created.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;primitives&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;featuretools.dfs&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sklearn.preprocessing.Imputer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sklearn.preprocessing.StandardScaler&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sklearn.ensemble.RandomForestClassifier&#39;</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">&#39;init_params&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;featuretools.dfs#1&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;encode&#39;</span><span class="p">:</span> <span class="bp">True</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">tsc</span> <span class="o">=</span> <span class="n">TimeSeriesClassifier</span><span class="p">(</span><span class="n">template</span><span class="o">=</span><span class="n">template</span><span class="p">)</span>
<span class="n">tsc</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tsc</span><span class="o">.</span><span class="n">score</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span><span class="p">.</span><span class="mi">5404040404040403</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tsc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">tsc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-guess notranslate"><div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="what-s-next">
<h2>What’s next?<a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>￼ ￼
￼For more details about <strong>water</strong> and all its possibilities and features, please check the
￼<a class="reference external" href="https://D3-AI.github.io/water/">project documentation site</a>!</p>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="readme.html" class="btn btn-neutral float-right" title="Water" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, MIT Data To AI Lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>